<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       autoReload="true"
        throwExceptions="true"
      internalLogLevel="Off"
      internalLogFile="C:\WSI_Logs\nlog.txt"
      >

  <extensions>
    <add assembly="Emsal.Utility"/>
  </extensions>
  <targets>
    <!-- write logs to file
     connectionString="Data Source=RXITM123\MSSQLSERVER2014N;Initial Catalog=EmsalDB;Integrated Security=true;"-->
    <target name="file" xsi:type="File"
                layout="${longdate} ${logger} ${message}"
                fileName="C:\WSI_Logs\log.txt"
                keepFileOpen="false"
                encoding="iso-8859-2" />

    <!-- write log message to database -->

    <target  name="Log" xsi:type="Database"  keepConnection="true"
     useTransactions="true"
    
      connectionString="Data Source=TEDARUK1;Initial Catalog=EmsalDB;User ID=sa;Password=remsal123456_; "
     commandText="INSERT INTO EmsalLog(LogType,ChannelId,RequestId,InsertDate,logger,Message,Origin,Loglevel
     ,exception,StackTrace,LineNumber,IpNumber)
     VALUES (@LogType,@ChannelId,@RequestId,@InsertDate, @logger,   @Message, @Origin, @Loglevel,
         @exception,@StackTrace,@LineNumber,@IpNumber)">
      <!--<parameter name="createDate" layout="${date:format=yyyy-MM-dd HH\:mm\:ss}"/>
      <parameter name ="logger"  layout="${logger}"/>-->
      <parameter name="LogType" layout="${LogType}"/>
      <parameter name="ChannelId" layout="${ChannelId}"/>
      <parameter name="RequestId" layout="${RequestId}"/>
      <parameter name="@InsertDate" layout="${date:format=yyyy-MM-dd HH\:mm\:ss}"/>
      <parameter name ="@logger"  layout="${logger}"/>
      <parameter name="@Message" layout="${message}" />
      <parameter name="Origin" layout="${callsite}"/>
      <parameter name="@Loglevel" layout="${level}" />



      <parameter name="exception" layout="${exception:format=Message,StackTrace}"/>

      <parameter name="@StackTrace" layout="${stacktrace}" />
      <parameter name="LineNumber" layout="${LineNumber}"/>
      <parameter name="IpNumber" layout="${IpNumber}"/>


    </target>

  </targets>

  <rules>

    <logger name="*" minlevel="Debug" writeTo="Log" />
    <logger name="*" minlevel="Debug" writeTo="file" />
  </rules>
</nlog>
